<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dungeon Delvers - 新紀元</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Toastify.js (用於非阻塞式提示) -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Favicon and Meta Tags -->
    <link rel="icon" href="/assets/images/favicon.ico" sizes="any">
    <link rel="icon" type="image/png" href="/assets/images/logo-192x192.png" sizes="192x192">
    <link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png">
    <link rel="manifest" href="/manifest.json">
    
    <!-- Open Graph Tags for Social Sharing -->
    <meta property="og:title" content="Dungeon Delvers - 你的奇幻冒險由此開始" />
    <meta property="og:description" content="招募傳奇英雄，組建最強隊伍，深入被遺忘的地下城，尋找蘊含著世界本源能量的「魂晶」($SoulShard)！" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.soulshard.fun/" />
    <meta property="og:image" content="https://www.soulshard.fun/assets/images/og-cover-image.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:site_name" content="Dungeon Delvers" />
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Dungeon Delvers - 你的奇幻冒險由此開始">
    <meta name="twitter:description" content="招募傳奇英雄，組建最強隊伍，深入被遺忘的地下城，尋找蘊含著世界本源能量的「魂晶」($SoulShard)！">
    <meta name="twitter:image" content="https://www.soulshard.fun/assets/images/twitter-cover-image.png">
    <meta property="twitter:url" content="https://www.soulshard.fun/">

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #FDF6E3; /* 羊皮紙背景色 */
        }
        .font-serif {
            font-family: 'Noto Serif TC', serif;
        }
        .card-bg {
            background-color: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        .btn-primary {
            background: linear-gradient(135deg, #8B5CF6, #6366F1);
            color: white;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
        }
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.5);
        }
        .btn-primary:disabled {
            background: #a5b4fc;
            cursor: not-allowed;
            box-shadow: none;
        }
        .nav-item {
            padding: 8px 16px;
            border-radius: 9999px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #E5E7EB;
        }
        .nav-item.active, .nav-item:hover {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
        }
        .text-shadow-gold {
            text-shadow: 1px 1px 3px rgba(252, 211, 77, 0.7);
        }
        .nft-card.selected {
            ring: 4px;
            ring-color: #8B5CF6;
            border-color: #8B5CF6;
        }
    </style>
</head>
<body class="bg-[#FDF6E3] text-gray-800">

    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-[#1F1D36] shadow-lg sticky top-0 z-50">
            <div class="container mx-auto px-4 py-3">
                <div class="flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <img src="https://www.soulshard.fun/assets/images/logo-192x192.png" alt="Dungeon Delvers Logo" class="h-12 w-12 rounded-full border-2 border-[#C0A573]">
                        <div>
                            <h1 class="text-2xl md:text-3xl font-bold text-white text-shadow-gold">Dungeon Delvers</h1>
                            <p class="text-sm text-gray-300">你的奇幻冒險由此開始</p>
                        </div>
                    </div>
                    <button id="connectWalletBtn" class="btn-primary px-4 py-2 rounded-full text-sm md:text-base">連接錢包</button>
                </div>
                <nav id="navigation" class="mt-4 flex flex-wrap justify-center gap-2 text-sm">
                    <a class="nav-item active" data-target="dashboard">儀表板</a>
                    <a class="nav-item" data-target="mint">鑄造</a>
                    <a class="nav-item" data-target="party">我的隊伍</a>
                    <a class="nav-item" data-target="dungeon">地下城</a>
                </nav>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-grow container mx-auto p-4 md:p-6">
            
            <!-- 儀表板 -->
            <section id="dashboard" class="page-content">
                <h2 class="text-3xl font-bold text-center mb-6 text-[#2D2A4A] font-serif">儀表板</h2>
                <div id="dashboard-status-panel" class="card-bg p-6 rounded-xl shadow-md grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-xl font-bold text-[#2D2A4A] mb-2">玩家狀態</h3>
                        <p>錢包地址: <span id="userAddress" class="font-mono text-sm break-all">尚未連接</span></p>
                        <p>$SoulShard 餘額: <span id="tokenBalance" class="font-bold text-yellow-600">0.00</span></p>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-[#2D2A4A] mb-2">個人金庫</h3>
                        <p>可提取餘額: <span id="withdrawableBalance" class="font-bold text-green-600">0.00</span> $SoulShard</p>
                        <div class="mt-2 flex gap-2">
                            <input type="number" id="withdrawAmount" placeholder="提領數量" class="w-full px-2 py-1 border rounded-md focus:ring-2 focus:ring-indigo-500 outline-none">
                            <button id="withdrawBtn" class="btn-primary px-4 py-1 rounded-lg text-sm whitespace-nowrap">提領</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 鑄造頁 -->
            <section id="mint" class="page-content hidden">
                <h2 class="text-3xl font-bold text-center mb-6 text-[#2D2A4A] font-serif">鑄造工坊</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="card-bg p-6 rounded-xl shadow-lg flex flex-col items-center">
                        <h3 class="text-2xl font-bold mb-4">招募英雄</h3>
                        <p class="text-center mb-6">花費 <span class="font-bold text-lg" id="heroMintPrice">2</span> USD 等值的 $SoulShard 招募一位英雄。</p>
                        <button id="mintHeroBtn" class="btn-primary px-8 py-3 rounded-lg text-lg">招募</button>
                    </div>
                    <div class="card-bg p-6 rounded-xl shadow-lg flex flex-col items-center">
                        <h3 class="text-2xl font-bold mb-4">鑄造聖物</h3>
                        <p class="text-center mb-6">花費 <span class="font-bold text-lg" id="relicMintPrice">2</span> USD 等值的 $SoulShard 鑄造一件聖物。</p>
                        <button id="mintRelicBtn" class="btn-primary px-8 py-3 rounded-lg text-lg">鑄造</button>
                    </div>
                </div>
            </section>

            <!-- 我的隊伍 -->
            <section id="party" class="page-content hidden">
                 <h2 class="text-3xl font-bold text-center mb-6 text-[#2D2A4A] font-serif">我的隊伍</h2>
                 <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- 左側: NFT 列表 -->
                    <div class="lg:col-span-2">
                        <div class="mb-8">
                            <h3 class="text-2xl font-bold mb-4 text-[#2D2A4A]">我的英雄</h3>
                            <div id="heroesContainer" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                                <p class="col-span-full text-center text-gray-500">尚未擁有英雄或未連接錢包。</p>
                            </div>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold mb-4 text-[#2D2A4A]">我的聖物</h3>
                            <div id="relicsContainer" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                                 <p class="col-span-full text-center text-gray-500">尚未擁有聖物或未連接錢包。</p>
                            </div>
                        </div>
                    </div>
                    <!-- 右側: 隊伍組建 -->
                    <div class="lg:col-span-1">
                        <div class="card-bg p-6 rounded-xl shadow-lg sticky top-24">
                            <h3 class="text-2xl font-bold mb-4 text-[#2D2A4A]">隊伍配置</h3>
                            <div id="partyComposition" class="space-y-4 min-h-[100px]">
                                <!-- JS 會填充這裡 -->
                            </div>
                            <div class="mt-4 flex flex-col gap-2">
                                <button id="createPartyBtn" class="btn-primary w-full py-2 rounded-lg">創建隊伍</button>
                                <p class="text-xs text-center text-gray-500 mt-1">(首次創建需授權NFT)</p>
                            </div>
                        </div>
                    </div>
                 </div>
            </section>

            <!-- 地下城 -->
            <section id="dungeon" class="page-content hidden">
                <h2 class="text-3xl font-bold text-center mb-6 text-[#2D2A4A] font-serif">地下城入口</h2>
                <div class="mb-8 card-bg p-4 rounded-xl">
                    <h3 class="text-xl font-bold mb-2 text-[#2D2A4A]">選擇隊伍</h3>
                    <select id="partySelector" class="w-full p-2 border rounded-lg bg-white/80">
                        <option value="">請先創建並選擇一個隊伍</option>
                    </select>
                </div>
                <div id="dungeonsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- JS 會填充這裡 -->
                </div>
            </section>

        </main>
        
        <!-- Footer -->
        <footer class="bg-[#1F1D36] text-gray-300 py-6 mt-8">
            <div class="container mx-auto text-center">
                <p class="font-serif text-lg text-white mb-2">加入我們的社群</p>
                <div class="flex justify-center gap-6 mb-4">
                    <!-- Twitter -->
                    <a href="https://twitter.com/your-twitter-handle" target="_blank" class="text-gray-400 hover:text-white transition-colors" aria-label="Twitter">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true">
                            <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.71v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"></path>
                        </svg>
                    </a>
                    <!-- Telegram -->
                    <a href="https://t.me/soulshard_BSC" target="_blank" class="text-gray-400 hover:text-white transition-colors" aria-label="Telegram">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14.9932 1.58221C15.0223 1.40736 14.9567 1.23016 14.8208 1.11645C14.6848 1.00274 14.4988 0.969519 14.3318 1.02914L0.331836 6.02914C0.143209 6.0965 0.0129867 6.26994 0.000913704 6.46987C-0.0111592 6.6698 0.0972469 6.85765 0.276398 6.94722L4.2764 8.94722C4.43688 9.02746 4.62806 9.01556 4.77735 8.91603L8.09775 6.70244L6.10957 9.18766C6.02203 9.29709 5.98442 9.43824 6.00592 9.57672C6.02742 9.7152 6.10605 9.8383 6.22265 9.91603L12.2227 13.916C12.3638 14.0101 12.5431 14.0262 12.6988 13.9588C12.8545 13.8914 12.9653 13.7496 12.9932 13.5822L14.9932 1.58221Z" fill="#ffffff" transform="translate(-0.8, 0.2)"/>
                        </svg>
                    </a>
                </div>
                <p class="text-xs">&copy; 2025 Dungeon Delvers. All Rights Reserved.</p>
            </div>
        </footer>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <!-- 【整合】從舊版加入 SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="script.js"></script>
</body>
</html>
