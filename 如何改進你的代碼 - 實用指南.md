# ğŸ”§ å¦‚ä½•æ”¹é€²ä½ çš„ä»£ç¢¼ - å¯¦ç”¨æŒ‡å—

> åŸºæ–¼å°ä½ å°ˆæ¡ˆçš„æ·±åº¦åˆ†æï¼Œé€™æ˜¯ä¸€å€‹å…·é«”çš„ä»£ç¢¼æ”¹é€²æ•™ç¨‹

## ğŸ¯ æœ€é‡è¦çš„æ”¹é€²ï¼ˆç«‹å³é–‹å§‹ï¼‰

### 1. ä¿®å¾© TypeScript éŒ¯èª¤ âš ï¸

**ç¾ç‹€å•é¡Œï¼š** ä½ çš„å°ˆæ¡ˆå¯èƒ½æœ‰ TypeScript éŒ¯èª¤å½±éŸ¿é–‹ç™¼é«”é©—

**ç«‹å³åŸ·è¡Œï¼š**
```bash
# æª¢æŸ¥ TypeScript éŒ¯èª¤
npm run type-check

# å¦‚æœæ²’æœ‰é€™å€‹å‘½ä»¤ï¼Œåœ¨ package.json æ·»åŠ ï¼š
"scripts": {
  "type-check": "tsc --noEmit"
}
```

**å¸¸è¦‹ä¿®å¾©ï¼š**
```typescript
// âŒ éŒ¯èª¤å¯«æ³•
const handleClick = (event) => {
  // TypeScript ä¸çŸ¥é“ event æ˜¯ä»€éº¼é¡å‹
}

// âœ… æ­£ç¢ºå¯«æ³•
const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {
  // TypeScript çŸ¥é“ç¢ºåˆ‡é¡å‹
}
```

### 2. å„ªåŒ– AdminPage.tsxï¼ˆ592è¡Œå¤ªå¤§ï¼‰

**ç¾ç‹€å•é¡Œï¼š** å–®å€‹æ–‡ä»¶å¤ªå¤§ï¼Œé›£ä»¥ç¶­è­·

**æ”¹é€²æ­¥é©Ÿï¼š**

#### æ­¥é©Ÿ1ï¼šå‰µå»ºå­çµ„ä»¶æ–‡ä»¶å¤¾
```bash
mkdir -p src/components/admin
```

#### æ­¥é©Ÿ2ï¼šæ‹†åˆ†ç”¨æˆ¶ç®¡ç†åŠŸèƒ½
```typescript
// src/components/admin/UserManagement.tsx
import React from 'react';

interface UserManagementProps {
  users: any[];
  onUserUpdate: (userId: string, data: any) => void;
}

export const UserManagement: React.FC<UserManagementProps> = ({ 
  users, 
  onUserUpdate 
}) => {
  return (
    <div className="space-y-4">
      <h2 className="text-xl font-bold">ç”¨æˆ¶ç®¡ç†</h2>
      {users.map(user => (
        <div key={user.id} className="border p-4 rounded">
          {/* ç”¨æˆ¶ç®¡ç† UI */}
        </div>
      ))}
    </div>
  );
};
```

#### æ­¥é©Ÿ3ï¼šæ‹†åˆ†åˆç´„è¨­ç½®åŠŸèƒ½
```typescript
// src/components/admin/ContractSettings.tsx
import React from 'react';

interface ContractSettingsProps {
  settings: any;
  onSettingChange: (key: string, value: any) => void;
}

export const ContractSettings: React.FC<ContractSettingsProps> = ({ 
  settings, 
  onSettingChange 
}) => {
  return (
    <div className="space-y-4">
      <h2 className="text-xl font-bold">åˆç´„è¨­ç½®</h2>
      {/* åˆç´„è¨­ç½® UI */}
    </div>
  );
};
```

#### æ­¥é©Ÿ4ï¼šé‡æ§‹ä¸» AdminPage
```typescript
// src/pages/AdminPage.tsx
import React, { Suspense } from 'react';
import { UserManagement } from '../components/admin/UserManagement';
import { ContractSettings } from '../components/admin/ContractSettings';
import { LoadingSpinner } from '../components/ui/LoadingSpinner';

const AdminPage: React.FC = () => {
  // ä¿ç•™ä¸»è¦é‚è¼¯å’Œç‹€æ…‹ç®¡ç†
  
  return (
    <div className="container mx-auto p-6">
      <h1 className="text-3xl font-bold mb-6">ç®¡ç†é¢æ¿</h1>
      
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <Suspense fallback={<LoadingSpinner />}>
          <UserManagement 
            users={users}
            onUserUpdate={handleUserUpdate}
          />
        </Suspense>
        
        <Suspense fallback={<LoadingSpinner />}>
          <ContractSettings 
            settings={settings}
            onSettingChange={handleSettingChange}
          />
        </Suspense>
      </div>
    </div>
  );
};

export default AdminPage;
```

### 3. æ”¹é€²éŒ¯èª¤è™•ç† ğŸš¨

**ç¾ç‹€å•é¡Œï¼š** ç¼ºå°‘çµ±ä¸€çš„éŒ¯èª¤è™•ç†

**å‰µå»ºéŒ¯èª¤é‚Šç•Œï¼š**
```typescript
// src/components/ErrorBoundary.tsx
import React, { Component, ErrorInfo, ReactNode } from 'react';

interface Props {
  children: ReactNode;
}

interface State {
  hasError: boolean;
  error?: Error;
}

export class ErrorBoundary extends Component<Props, State> {
  public state: State = {
    hasError: false
  };

  public static getDerivedStateFromError(error: Error): State {
    return { hasError: true, error };
  }

  public componentDidCatch(error: Error, errorInfo: ErrorInfo) {
    console.error('ErrorBoundary caught an error:', error, errorInfo);
  }

  public render() {
    if (this.state.hasError) {
      return (
        <div className="min-h-screen flex items-center justify-center bg-gray-100">
          <div className="text-center">
            <h2 className="text-2xl font-bold text-red-600 mb-4">
              æ‡‰ç”¨ç¨‹å¼ç™¼ç”ŸéŒ¯èª¤
            </h2>
            <p className="text-gray-600 mb-4">
              æˆ‘å€‘æ­£åœ¨è™•ç†é€™å€‹å•é¡Œï¼Œè«‹ç¨å¾Œå†è©¦ã€‚
            </p>
            <button
              onClick={() => window.location.reload()}
              className="btn-primary"
            >
              é‡æ–°è¼‰å…¥
            </button>
          </div>
        </div>
      );
    }

    return this.props.children;
  }
}
```

**åœ¨ App.tsx ä¸­ä½¿ç”¨ï¼š**
```typescript
// src/App.tsx
import { ErrorBoundary } from './components/ErrorBoundary';

function App() {
  return (
    <ErrorBoundary>
      <div className="min-h-screen flex flex-col dark:bg-gray-900 bg-gray-100">
        {/* ä½ çš„ç¾æœ‰å…§å®¹ */}
      </div>
    </ErrorBoundary>
  );
}
```

### 4. å„ªåŒ– Web3 è«‹æ±‚ âš¡

**ç¾ç‹€å•é¡Œï¼š** å¯èƒ½æœ‰é‡è¤‡çš„åˆç´„è«‹æ±‚

**æ”¹é€²å‰ï¼š**
```typescript
// âŒ å¤šæ¬¡å–®ç¨è«‹æ±‚
const { data: heroCount } = useContractRead({
  address: heroContract,
  abi: heroABI,
  functionName: 'totalSupply',
});

const { data: relicCount } = useContractRead({
  address: relicContract,
  abi: relicABI,
  functionName: 'totalSupply',
});
```

**æ”¹é€²å¾Œï¼š**
```typescript
// âœ… æ‰¹é‡è«‹æ±‚
const contracts = [
  {
    address: heroContract,
    abi: heroABI,
    functionName: 'totalSupply',
  },
  {
    address: relicContract,
    abi: relicABI,
    functionName: 'totalSupply',
  },
] as const;

const { data: contractData } = useContractReads({
  contracts,
  watch: false, // é¿å…ä¸å¿…è¦çš„è¼ªè©¢
  cacheTime: 60000, // 1åˆ†é˜ç·©å­˜
});

// è§£æ§‹æ•¸æ“š
const [heroCount, relicCount] = contractData || [];
```

### 5. æ”¹é€²åœ–ç‰‡è¼‰å…¥ ğŸ–¼ï¸

**ç¾ç‹€å•é¡Œï¼š** åœ–ç‰‡è¼‰å…¥å¯èƒ½å½±éŸ¿æ€§èƒ½

**å‰µå»ºå„ªåŒ–çš„åœ–ç‰‡çµ„ä»¶ï¼š**
```typescript
// src/components/ui/OptimizedImage.tsx
import React, { useState } from 'react';
import { LoadingSpinner } from './LoadingSpinner';

interface OptimizedImageProps {
  src: string;
  alt: string;
  className?: string;
  placeholder?: string;
}

export const OptimizedImage: React.FC<OptimizedImageProps> = ({
  src,
  alt,
  className = '',
  placeholder = '/images/placeholder.svg'
}) => {
  const [isLoading, setIsLoading] = useState(true);
  const [hasError, setHasError] = useState(false);

  const handleLoad = () => {
    setIsLoading(false);
  };

  const handleError = () => {
    setIsLoading(false);
    setHasError(true);
  };

  return (
    <div className={`relative ${className}`}>
      {isLoading && (
        <div className="absolute inset-0 flex items-center justify-center bg-gray-200">
          <LoadingSpinner size="h-8 w-8" />
        </div>
      )}
      
      <img
        src={hasError ? placeholder : src}
        alt={alt}
        onLoad={handleLoad}
        onError={handleError}
        loading="lazy"
        className={`w-full h-full object-cover ${isLoading ? 'opacity-0' : 'opacity-100'} transition-opacity duration-300`}
      />
    </div>
  );
};
```

### 6. æ”¹é€²ç‹€æ…‹ç®¡ç† ğŸ“Š

**ç¾ç‹€å•é¡Œï¼š** å¯èƒ½æœ‰é‡è¤‡çš„ç‹€æ…‹æˆ–ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“

**ä½¿ç”¨ React Query å„ªåŒ–ï¼š**
```typescript
// src/hooks/useGameData.ts
import { useQuery } from '@tanstack/react-query';

export const useGameData = (address?: string) => {
  return useQuery({
    queryKey: ['gameData', address],
    queryFn: async () => {
      // æ‰¹é‡ç²å–ç”¨æˆ¶æ•¸æ“š
      const [userHeroes, userRelics, userParties] = await Promise.all([
        fetchUserHeroes(address),
        fetchUserRelics(address),
        fetchUserParties(address),
      ]);
      
      return {
        heroes: userHeroes,
        relics: userRelics,
        parties: userParties,
      };
    },
    enabled: !!address,
    staleTime: 30000, // 30ç§’å…§èªç‚ºæ•¸æ“šæ–°é®®
    cacheTime: 300000, // 5åˆ†é˜ç·©å­˜
  });
};
```

### 7. æ”¹é€² CSS å’Œæ¨£å¼ ğŸ¨

**ç¾ç‹€å•é¡Œï¼š** å¯èƒ½æœ‰é‡è¤‡çš„æ¨£å¼æˆ–ä¸ä¸€è‡´çš„è¨­è¨ˆ

**å‰µå»ºçµ±ä¸€çš„è¨­è¨ˆç³»çµ±ï¼š**
```typescript
// src/styles/design-system.ts
export const designSystem = {
  colors: {
    primary: {
      50: '#eff6ff',
      500: '#3b82f6',
      600: '#2563eb',
      700: '#1d4ed8',
    },
    gray: {
      50: '#f9fafb',
      100: '#f3f4f6',
      500: '#6b7280',
      900: '#111827',
    },
  },
  spacing: {
    xs: '0.5rem',
    sm: '1rem',
    md: '1.5rem',
    lg: '2rem',
    xl: '3rem',
  },
  borderRadius: {
    sm: '0.25rem',
    md: '0.5rem',
    lg: '1rem',
    full: '9999px',
  },
} as const;
```

**ä½¿ç”¨è¨­è¨ˆç³»çµ±ï¼š**
```typescript
// src/components/ui/Card.tsx
import React from 'react';
import { designSystem } from '../../styles/design-system';

interface CardProps {
  children: React.ReactNode;
  className?: string;
}

export const Card: React.FC<CardProps> = ({ children, className = '' }) => {
  return (
    <div 
      className={`
        bg-white dark:bg-gray-800 
        rounded-lg shadow-md 
        p-6 
        border border-gray-200 dark:border-gray-700
        ${className}
      `}
    >
      {children}
    </div>
  );
};
```

## ğŸš€ ç«‹å³è¡Œå‹•è¨ˆåŠƒ

### ä»Šå¤©å°±å¯ä»¥åšçš„ï¼ˆ1-2å°æ™‚ï¼‰ï¼š
1. åŸ·è¡Œ `npm run type-check` ä¿®å¾© TypeScript éŒ¯èª¤
2. å‰µå»º `ErrorBoundary` çµ„ä»¶ä¸¦åŒ…è£ä½ çš„ App
3. å‰µå»º `OptimizedImage` çµ„ä»¶æ›¿æ›ç¾æœ‰åœ–ç‰‡

### æœ¬é€±å¯ä»¥å®Œæˆçš„ï¼ˆ3-5å°æ™‚ï¼‰ï¼š
1. æ‹†åˆ† `AdminPage.tsx` æˆå¤šå€‹å°çµ„ä»¶
2. å¯¦æ–½ Web3 è«‹æ±‚å„ªåŒ–
3. å‰µå»ºçµ±ä¸€çš„è¨­è¨ˆç³»çµ±

### æœ¬æœˆçš„ç›®æ¨™ï¼ˆ10-15å°æ™‚ï¼‰ï¼š
1. å®Œæˆæ‰€æœ‰çµ„ä»¶çš„æ¸¬è©¦
2. å¯¦æ–½ä»£ç¢¼åˆ†å‰²å’Œ bundle å„ªåŒ–
3. è¨­ç½® CI/CD æµç¨‹

## ğŸ“Š å¦‚ä½•è¡¡é‡æ”¹é€²æ•ˆæœ

### æ€§èƒ½æŒ‡æ¨™ï¼š
```bash
# æª¢æŸ¥ bundle å¤§å°
npm run build
ls -la dist/assets/

# æ¸¬è©¦è¼‰å…¥æ™‚é–“
npm run dev
# åœ¨ç€è¦½å™¨ä¸­ä½¿ç”¨ Lighthouse æ¸¬è©¦
```

### ä»£ç¢¼è³ªé‡ï¼š
```bash
# TypeScript éŒ¯èª¤æ•¸é‡
npm run type-check

# æ¸¬è©¦è¦†è“‹ç‡
npm run test:coverage

# ä»£ç¢¼è¤‡é›œåº¦
npx madge --circular src/
```

## ğŸ¯ å„ªå…ˆé †åºå»ºè­°

1. **ğŸ”¥ ç«‹å³ä¿®å¾©ï¼š** TypeScript éŒ¯èª¤å’ŒåŸºæœ¬éŒ¯èª¤è™•ç†
2. **âš¡ å¿«é€Ÿæ”¹é€²ï¼š** åœ–ç‰‡å„ªåŒ–å’Œ Web3 è«‹æ±‚å„ªåŒ–
3. **ğŸ”§ é‡æ§‹ï¼š** æ‹†åˆ†å¤§å‹çµ„ä»¶å’Œæ”¹é€²ç‹€æ…‹ç®¡ç†
4. **ğŸš€ é•·æœŸï¼š** å®Œå–„æ¸¬è©¦å’Œ CI/CD

## ğŸ’¡ å¯¦ç”¨æŠ€å·§

### 1. ä½¿ç”¨ VS Code æ“´å±•æé«˜æ•ˆç‡ï¼š
- TypeScript Importer
- Auto Rename Tag
- Bracket Pair Colorizer
- GitLens

### 2. è¨­ç½® ESLint å’Œ Prettierï¼š
```bash
npm install --save-dev eslint prettier @typescript-eslint/eslint-plugin
```

### 3. ä½¿ç”¨ React DevToolsï¼š
- React Developer Tools
- React Query DevTools

---

**ä½ æƒ³å¾å“ªå€‹æ”¹é€²é–‹å§‹ï¼Ÿæˆ‘å¯ä»¥æä¾›æ›´è©³ç´°çš„æŒ‡å°ï¼** ğŸš€

å¦‚æœä½ é‡åˆ°ä»»ä½•å•é¡Œï¼Œéš¨æ™‚å‘Šè¨´æˆ‘å…·é«”çš„éŒ¯èª¤ä¿¡æ¯æˆ–ä»£ç¢¼ç‰‡æ®µï¼Œæˆ‘æœƒå¹«ä½ è§£æ±ºï¼