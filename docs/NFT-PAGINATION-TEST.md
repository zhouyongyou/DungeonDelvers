# NFT 分頁查詢測試指南

## 🧪 測試場景

### 1. 基本功能測試
- [ ] 總覽頁面顯示正確的 NFT 總數
- [ ] 我的資產頁面能顯示所有 NFT（超過 100 個）
- [ ] 祭壇頁面能顯示所有符合條件的 NFT
- [ ] 隊伍建設器能顯示所有英雄和聖物

### 2. 大量數據測試（重要）
測試帳號需要擁有：
- [ ] 200+ 英雄
- [ ] 200+ 聖物  
- [ ] 50+ 隊伍

驗證項目：
- [ ] 總覽頁面的統計數據正確（使用 stats 對象）
- [ ] 資產頁面能完整顯示所有 NFT
- [ ] 滾動載入流暢，無卡頓
- [ ] 篩選和排序功能正常

### 3. 性能測試
- [ ] 頁面載入時間 < 3 秒
- [ ] 切換標籤頁響應時間 < 500ms
- [ ] 記憶體使用穩定，無洩漏

## 📊 查詢限制說明

### The Graph 限制
- 默認返回：100 條（未指定 first）
- 單次最大：1000 條
- 超過限制：需要分頁

### 實現策略
1. **統計數據**：使用 `player.stats` 對象
2. **列表顯示**：自動分頁獲取所有數據
3. **性能優化**：使用 1000 條/頁減少請求

## 🔍 測試方法

### 1. 檢查網路請求
打開瀏覽器開發者工具，查看 Network 標籤：
```
- 查詢應該包含 first: 1000
- 如果數據超過 1000，應該有多個請求（skip: 0, 1000, 2000...）
```

### 2. 驗證數據完整性
```javascript
// 在控制台執行
const nftStore = window.__nftStore; // 如果有暴露
console.log('英雄總數:', nftStore?.nfts?.heros?.length);
console.log('聖物總數:', nftStore?.nfts?.relics?.length);
```

### 3. 性能監控
使用 Chrome DevTools Performance 標籤記錄：
- 頁面載入
- 標籤切換
- 滾動操作

## 🐛 已知問題與解決

### 問題 1：只顯示 100 個 NFT
**原因**：查詢未指定 first 參數
**解決**：已修復，現在使用 first: 1000

### 問題 2：統計數字不準確
**原因**：使用數組長度而非 stats
**解決**：改用 player.stats.totalHeroes/totalRelics

### 問題 3：載入緩慢
**原因**：每頁只查詢 100 條
**解決**：改為 1000 條/頁，減少請求次數

## 📝 測試清單

### 開發環境
- [ ] 本地測試通過
- [ ] 控制台無錯誤
- [ ] 網路請求正常

### 生產環境
- [ ] Vercel 部署成功
- [ ] 線上環境正常顯示
- [ ] 大量數據用戶反饋

## 🚀 後續優化建議

1. **虛擬滾動**
   - 當 NFT > 500 個時啟用
   - 使用 react-window 或類似庫

2. **漸進式載入**
   - 先顯示前 100 個
   - 背景載入剩餘數據

3. **本地緩存**
   - IndexedDB 存儲 NFT 數據
   - 減少重複請求

4. **智能預載**
   - 預測用戶行為
   - 提前載入可能需要的數據